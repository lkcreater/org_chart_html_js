<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Organizational Chart</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #f5f5f5;
      overflow: hidden;
    }

    .container {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }

    .controls {
      position: absolute;
      top: 16px;
      right: 16px;
      z-index: 10;
      display: flex;
      gap: 8px;
    }

    .control-btn {
      width: 40px;
      height: 40px;
      background: white;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      transition: all 0.2s;
    }

    .control-btn:hover {
      background: #f0f0f0;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .control-btn:active {
      transform: translateY(0);
    }

    svg {
      width: 100%;
      height: 100%;
    }

    .cursor-grab {
      cursor: grab;
    }

    .cursor-grabbing {
      cursor: grabbing;
    }

    .node-group {
      transition: opacity 0.2s;
    }

    .node-group:hover {
      opacity: 0.9;
    }

    .node-rect {
      transition: filter 0.2s;
    }

    .node-rect:hover {
      filter: brightness(1.1);
    }

    /* Category colors */
    .cat-leadership { fill: #3b82f6; }
    .cat-directorate { fill: #8b5cf6; }
    .cat-technical { fill: #10b981; }
    .cat-systems { fill: #f59e0b; }
    .cat-operations { fill: #ec4899; }
    .cat-hr { fill: #06b6d4; }

    .text-white { fill: white; }
    .text-dark { fill: #1f2937; }
  </style>
</head>
<body>
  <div class="container">
    <!-- Controls -->
    <div class="controls">
      <button class="control-btn" onclick="chart.zoomIn()" title="Zoom In">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <line x1="11" y1="8" x2="11" y2="14"></line>
          <line x1="8" y1="11" x2="14" y2="11"></line>
          <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </button>
      <button class="control-btn" onclick="chart.zoomOut()" title="Zoom Out">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <line x1="8" y1="11" x2="14" y2="11"></line>
          <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </button>
      <button class="control-btn" onclick="chart.reset()" title="Reset View">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 3 21 3 21 9"></polyline>
          <polyline points="9 21 3 21 3 15"></polyline>
          <line x1="21" y1="3" x2="14" y2="10"></line>
          <line x1="3" y1="21" x2="10" y2="14"></line>
        </svg>
      </button>
    </div>

    <!-- SVG Canvas -->
    <svg id="chartSvg" class="cursor-grab"></svg>
  </div>

  <script>
    const nodes = [
      // Leadership Level
      { id: '1', label: 'IDP Steering Committee', category: 'leadership', x: 50, y: 50, width: 200 },
      { id: '2', label: 'Executive Director Africa Region', category: 'leadership', x: 50, y: 150, width: 220 },
      
      // Ministerial Conference Branch
      { id: '3', label: 'Ministerial Conference', category: 'technical', x: 350, y: 50, width: 200 },
      { id: '4', label: 'RIMES Council', category: 'technical', x: 350, y: 140, width: 180 },
      { id: '5', label: 'Secretariat', category: 'technical', x: 350, y: 230, width: 160 },
      { id: '6', label: 'Director General', category: 'technical', x: 350, y: 320, width: 180 },
      { id: '7', label: 'IDP Implementation', category: 'technical', x: 350, y: 410, width: 180 },

      // Science and Technology Service Directorate
      { id: '8', label: 'Science and Technology Service Directorate', category: 'directorate', x: 650, y: 50, width: 280 },
      { id: '9', label: 'Earthquake, Tsunami and Ocean Services Department', category: 'technical', x: 1000, y: 20, width: 320 },
      { id: '10', label: 'Department Head', category: 'technical', x: 1380, y: 20, width: 150 },
      { id: '11', label: 'Ocean and Marine Scientist', category: 'technical', x: 1580, y: 20, width: 180 },
      { id: '12', label: 'Tsunami Modeler', category: 'technical', x: 1810, y: 20, width: 150 },

      { id: '13', label: 'Weather, Climate and Hydrological Services Department', category: 'technical', x: 1000, y: 100, width: 350 },
      { id: '14', label: 'Department Head', category: 'technical', x: 1400, y: 100, width: 150 },
      { id: '15', label: 'Weather and Climate Scientist', category: 'technical', x: 1600, y: 100, width: 200 },
      { id: '16', label: 'Numerical Weather Prediction Expert', category: 'technical', x: 1850, y: 100, width: 240 },

      // Program Management Directorate
      { id: '17', label: 'Program Management Directorate', category: 'directorate', x: 650, y: 200, width: 260 },
      { id: '18', label: 'Systems Research and Development Department', category: 'systems', x: 980, y: 180, width: 310 },
      { id: '19', label: 'Department Head', category: 'systems', x: 1340, y: 180, width: 150 },
      { id: '20', label: 'Full Stack Developer', category: 'systems', x: 1540, y: 180, width: 170 },
      { id: '21', label: 'Application Developer', category: 'systems', x: 1760, y: 180, width: 180 },

      { id: '22', label: 'Societal Applications Department', category: 'systems', x: 980, y: 260, width: 250 },
      { id: '23', label: 'Department Head', category: 'systems', x: 1280, y: 260, width: 150 },
      { id: '24', label: 'Climate Risk Assessment Specialist', category: 'systems', x: 1480, y: 260, width: 230 },
      { id: '25', label: 'Forecast Application Project Coordinator', category: 'systems', x: 1760, y: 260, width: 260 },

      { id: '26', label: 'Program Management Department', category: 'systems', x: 980, y: 340, width: 250 },
      { id: '27', label: 'Department Head', category: 'systems', x: 1280, y: 340, width: 150 },
      { id: '28', label: 'Program Manager', category: 'systems', x: 1480, y: 340, width: 160 },
      { id: '29', label: 'Project Coordinator', category: 'systems', x: 1690, y: 340, width: 170 },

      { id: '30', label: 'Country Program', category: 'operations', x: 980, y: 420, width: 170 },
      { id: '31', label: 'Country Director Country Program Lead', category: 'operations', x: 1200, y: 420, width: 270 },
      { id: '32', label: 'Science and Technology Division', category: 'operations', x: 1520, y: 420, width: 230 },

      { id: '33', label: 'Finance and Account Management Department', category: 'operations', x: 980, y: 500, width: 300 },
      { id: '34', label: 'Chief Financial Officer', category: 'operations', x: 1330, y: 500, width: 180 },
      { id: '35', label: 'Finance Management Specialist', category: 'operations', x: 1560, y: 500, width: 220 },

      // Operational Support Directorate
      { id: '36', label: 'Operational Support Directorate', category: 'directorate', x: 650, y: 580, width: 260 },
      { id: '37', label: 'Human Resource and Administration Department', category: 'hr', x: 980, y: 560, width: 320 },
      { id: '38', label: 'Department Head', category: 'hr', x: 1350, y: 560, width: 150 },
      { id: '39', label: 'Human Resource and Administration Manager', category: 'hr', x: 1550, y: 560, width: 290 },
      { id: '40', label: 'Human Resource and Administration Officer', category: 'hr', x: 1890, y: 560, width: 280 },

      { id: '41', label: 'Procurement Department', category: 'hr', x: 980, y: 640, width: 200 },
      { id: '42', label: 'Chief Procurement', category: 'hr', x: 1230, y: 640, width: 170 },
      { id: '43', label: 'Procurement Manager', category: 'hr', x: 1450, y: 640, width: 180 },
      { id: '44', label: 'Procurement Officer', category: 'hr', x: 1680, y: 640, width: 170 },

      { id: '45', label: 'Policy Management Department', category: 'hr', x: 980, y: 720, width: 240 },
      { id: '46', label: 'Department Head', category: 'hr', x: 1270, y: 720, width: 150 },
      { id: '47', label: 'Legal Compliance Specialist', category: 'hr', x: 1470, y: 720, width: 210 },
      { id: '48', label: 'Operations Specialist', category: 'hr', x: 1730, y: 720, width: 180 }
    ];

    const connections = [
      { from: '1', to: '2' }, { from: '2', to: '3' }, { from: '3', to: '4' },
      { from: '4', to: '5' }, { from: '5', to: '6' }, { from: '6', to: '7' },
      { from: '6', to: '8' }, { from: '6', to: '17' }, { from: '6', to: '36' },
      { from: '8', to: '9' }, { from: '9', to: '10' }, { from: '10', to: '11' },
      { from: '11', to: '12' }, { from: '8', to: '13' }, { from: '13', to: '14' },
      { from: '14', to: '15' }, { from: '15', to: '16' }, { from: '17', to: '18' },
      { from: '18', to: '19' }, { from: '19', to: '20' }, { from: '20', to: '21' },
      { from: '17', to: '22' }, { from: '22', to: '23' }, { from: '23', to: '24' },
      { from: '24', to: '25' }, { from: '17', to: '26' }, { from: '26', to: '27' },
      { from: '27', to: '28' }, { from: '28', to: '29' }, { from: '17', to: '30' },
      { from: '30', to: '31' }, { from: '31', to: '32' }, { from: '17', to: '33' },
      { from: '33', to: '34' }, { from: '34', to: '35' }, { from: '36', to: '37' },
      { from: '37', to: '38' }, { from: '38', to: '39' }, { from: '39', to: '40' },
      { from: '36', to: '41' }, { from: '41', to: '42' }, { from: '42', to: '43' },
      { from: '43', to: '44' }, { from: '36', to: '45' }, { from: '45', to: '46' },
      { from: '46', to: '47' }, { from: '47', to: '48' }
    ];

    class OrganizationalChart {
      constructor() {
        this.zoom = 1;
        this.pan = { x: 0, y: 0 };
        this.isDragging = false;
        this.dragStart = { x: 0, y: 0 };
        
        this.svg = document.getElementById('chartSvg');
        this.setupEventListeners();
        this.render();
      }

      setupEventListeners() {
        this.svg.addEventListener('mousedown', (e) => this.handleMouseDown(e));
        this.svg.addEventListener('mousemove', (e) => this.handleMouseMove(e));
        this.svg.addEventListener('mouseup', () => this.handleMouseUp());
        this.svg.addEventListener('mouseleave', () => this.handleMouseUp());
      }

      handleMouseDown(e) {
        this.isDragging = true;
        this.dragStart = {
          x: e.clientX - this.pan.x,
          y: e.clientY - this.pan.y
        };
        this.svg.classList.remove('cursor-grab');
        this.svg.classList.add('cursor-grabbing');
      }

      handleMouseMove(e) {
        if (!this.isDragging) return;
        this.pan = {
          x: e.clientX - this.dragStart.x,
          y: e.clientY - this.dragStart.y
        };
        this.updateTransform();
      }

      handleMouseUp() {
        this.isDragging = false;
        this.svg.classList.remove('cursor-grabbing');
        this.svg.classList.add('cursor-grab');
      }

      zoomIn() {
        this.zoom = Math.min(this.zoom + 0.2, 2);
        this.updateTransform();
      }

      zoomOut() {
        this.zoom = Math.max(this.zoom - 0.2, 0.5);
        this.updateTransform();
      }

      reset() {
        this.zoom = 1;
        this.pan = { x: 0, y: 0 };
        this.updateTransform();
      }

      updateTransform() {
        const g = this.svg.querySelector('g');
        if (g) {
          g.setAttribute('transform', `translate(${this.pan.x}, ${this.pan.y}) scale(${this.zoom})`);
        }
      }

      getNodeCenter(node) {
        return {
          x: node.x + (node.width || 200) / 2,
          y: node.y + 20
        };
      }

      createPath(from, to) {
        const fromCenter = this.getNodeCenter(from);
        const toCenter = this.getNodeCenter(to);
        
        const fromX = fromCenter.x + (from.width || 200) / 2;
        const fromY = fromCenter.y;
        const toX = toCenter.x - (to.width || 200) / 2;
        const toY = toCenter.y;
        const midX = (fromX + toX) / 2;

        return `M ${fromX} ${fromY} C ${midX} ${fromY}, ${midX} ${toY}, ${toX} ${toY}`;
      }

      render() {
        this.svg.innerHTML = '';
        
        const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
        
        // Draw connections
        connections.forEach(conn => {
          const fromNode = nodes.find(n => n.id === conn.from);
          const toNode = nodes.find(n => n.id === conn.to);
          if (!fromNode || !toNode) return;

          const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
          path.setAttribute('d', this.createPath(fromNode, toNode));
          path.setAttribute('stroke', '#e0e0e0');
          path.setAttribute('stroke-width', '2');
          path.setAttribute('fill', 'none');
          g.appendChild(path);
        });

        // Draw nodes
        nodes.forEach(node => {
          const width = node.width || 200;
          const height = node.height || 40;
          
          const nodeGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
          nodeGroup.classList.add('node-group');

          const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
          rect.setAttribute('x', node.x);
          rect.setAttribute('y', node.y);
          rect.setAttribute('width', width);
          rect.setAttribute('height', height);
          rect.setAttribute('rx', '20');
          rect.setAttribute('ry', '20');
          rect.classList.add('node-rect', `cat-${node.category}`);
          rect.setAttribute('stroke', 'white');
          rect.setAttribute('stroke-width', '2');
          rect.style.filter = 'drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1))';

          const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          text.setAttribute('x', node.x + width / 2);
          text.setAttribute('y', node.y + height / 2);
          text.setAttribute('text-anchor', 'middle');
          text.setAttribute('dominant-baseline', 'middle');
          text.classList.add('text-white');
          text.setAttribute('font-size', '13');
          text.setAttribute('font-weight', '500');
          text.style.pointerEvents = 'none';
          text.style.userSelect = 'none';

          if (node.label.length > 30) {
            const tspan1 = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');
            tspan1.setAttribute('x', node.x + width / 2);
            tspan1.setAttribute('dy', '-0.3em');
            tspan1.textContent = node.label.substring(0, 30);
            
            const tspan2 = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');
            tspan2.setAttribute('x', node.x + width / 2);
            tspan2.setAttribute('dy', '1.2em');
            tspan2.textContent = node.label.substring(30);
            
            text.appendChild(tspan1);
            text.appendChild(tspan2);
          } else {
            text.textContent = node.label;
          }

          nodeGroup.appendChild(rect);
          nodeGroup.appendChild(text);
          g.appendChild(nodeGroup);
        });

        this.svg.appendChild(g);
        this.updateTransform();
      }
    }

    const chart = new OrganizationalChart();
  </script>
</body>
</html>
